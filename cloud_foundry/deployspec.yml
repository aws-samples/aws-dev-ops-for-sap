version: 0.2

env:
  parameter-store:
    SCP_USER: SCP_USER
    SCP_PW: SCP_PW
    SCP_OU: SCP_OU

phases:
  install:
    runtime-versions:
      java: openjdk8

  build:
    commands:
       - wget -q -O - https://packages.cloudfoundry.org/debian/cli.cloudfoundry.org.key | sudo apt-key add -
       - echo "deb https://packages.cloudfoundry.org/debian stable main" | sudo tee /etc/apt/sources.list.d/cloudfoundry-cli.list
       - sudo apt-get update
       - sudo apt-get install cf-cli
       - cf api https://api.cf.eu10.hana.ondemand.com
       - echo "Deploying as"
       - echo $SCP_USER
       - cf login -u $SCP_USER -p $SCP_PW -o $SCP_OU -s dev
       - cf push
